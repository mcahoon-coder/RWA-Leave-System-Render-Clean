{% extends "base.html" %}
{% block content %}
<div class="card">
  <h2>Manage Users</h2>
  <form method="post" action="{{ url_for('admin_create_user') }}">
    <h3>Create User</h3>
    <label>Username:<br><input type="text" name="username"></label><br>
    <label>Email:<br><input type="email" name="email"></label><br>
    <label>Role:
      <select name="role">
        <option value="faculty/staff">Faculty/Staff</option>
        <option value="admin">Admin</option>
      </select>
    </label><br>
    <label>Hours Balance:<br><input type="number" step="0.1" name="hours_balance"></label><br>
    <label>Password:<br><input type="password" name="password"></label><br>
    <button type="submit">Create</button>
  </form>
</div>

<div class="card">
  <h3>Existing Users</h3>
  <table>
    <tr><th>Username</th><th>Email</th><th>Role</th><th>Hours</th><th>Actions</th></tr>
    {% for u in users %}
    <tr>
      <form method="post" action="{{ url_for('admin_update_user', user_id=u.id) }}">
        <td><input type="text" name="username" value="{{ u.username }}"></td>
        <td><input type="email" name="email" value="{{ u.email }}"></td>
        <td>
          <select name="role">
            <option value="faculty/staff" {% if u.role == 'faculty/staff' %}selected{% endif %}>Faculty/Staff</option>
            <option value="admin" {% if u.role == 'admin' %}selected{% endif %}>Admin</option>
          </select>
        </td>
        <td><input type="number" step="0.1" name="hours_balance" value="{{ u.hours_balance }}"></td>
        <td>
          <button type="submit">Update</button>
        </form>
        <form method="post" action="{{ url_for('admin_delete_user', user_id=u.id) }}" onsubmit="return confirm('Delete user {{ u.username }}?');">
          <button>Delete</button>
        </form>
        </td>
    </tr>
    {% endfor %}
  </table>
</div>
{% endblock %}
