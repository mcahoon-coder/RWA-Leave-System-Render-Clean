{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="card">
  <div class="row">
    <h2>Welcome, {{ me.username }}</h2>
    <div class="right muted">
      Current Balance:
      {% if me.hours_balance < 0 %}
        <span class="text-danger">{{ '%.2f'|format(me.hours_balance) }} h</span>
      {% else %}
        <span class="text-success">{{ '%.2f'|format(me.hours_balance) }} h</span>
      {% endif %}
    </div>
  </div>
  <div class="row" style="margin-top:10px;">
    <a class="btn" href="{{ NAV.new_request }}">New Request</a>
    <a class="btn ghost" href="{{ NAV.my_requests }}">My Requests</a>
    <a class="btn ghost" href="{{ NAV.team_calendar }}">Calendar</a>
    {% if NAV.admin %}<a class="btn ghost" href="{{ NAV.admin }}">Admin</a>{% endif %}
  </div>
</div>

<div class="card">
  <h3 style="margin-bottom:.6rem;">Recent Activity</h3>
  <table class="table-tight">
    <thead>
      <tr>
        <th>#</th>
        <th>Kind</th>
        <th>Mode</th>
        <th>Dates</th>
        <th>Hours</th>
        <th>School</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
      {% for r in recent %}
      <tr>
        <td>{{ r.id }}</td>
        <td>{{ r.kind|capitalize }}</td>
        <td>{{ r.mode|capitalize }}</td>
        <td>
          {{ r.start_date.strftime('%Y-%m-%d') }}
          {% if r.end_date != r.start_date %} → {{ r.end_date.strftime('%Y-%m-%d') }}{% endif %}
          {% if r.start_time %}<div class="muted">Time: {{ r.start_time }}{% if r.end_time %}–{{ r.end_time }}{% endif %}</div>{% endif %}
        </td>
        <td>{{ '%.2f'|format(r.hours) }}</td>
        <td>{% if r.is_school_related %}Yes{% else %}No{% endif %}</td>
        <td>{{ r.status }}</td>
      </tr>
      {% else %}
      <tr><td colspan="7" class="muted">No recent requests.</td></tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
