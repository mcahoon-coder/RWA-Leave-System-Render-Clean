{% extends "base.html" %}
{% block title %}Calendar · RWA Leave{% endblock %}

{% block head %}
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css" rel="stylesheet">
  <style>
    #calendar {
      background:#111827; border:1px solid #1f2937; border-radius:12px;
      padding:12px; min-height:600px;
    }
    .cal-status { margin:8px 0 16px; font-size:0.95rem; opacity:0.85; }
  </style>
{% endblock %}

{% block content %}
  <h1>Team Calendar</h1>
  <div id="cal-status" class="cal-status">Loading calendar…</div>
  <div id="calendar"></div>
{% endblock %}

{% block scripts %}
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const statusEl = document.getElementById("cal-status");
      const el = document.getElementById("calendar");

      const calendar = new FullCalendar.Calendar(el, {
        initialView: "dayGridMonth",
        headerToolbar: { left: "prev,next today", center: "title", right: "dayGridMonth,timeGridWeek,timeGridDay,listWeek" },
        navLinks: true,
        nowIndicator: true,
        eventTimeFormat: { hour: '2-digit', minute: '2-digit', meridiem: false },
        events: {
          url: "{{ url_for('calendar_data') }}",
          failure: function(err){ console.error(err); if (statusEl) statusEl.textContent = "Could not load events."; }
        },
        loading: function(isLoading){ if (statusEl) statusEl.textContent = isLoading ? "Loading calendar…" : ""; }
      });

      calendar.render();
    });
  </script>
{% endblock %}
