{% extends "base.html" %}
{% block title %}Calendar{% endblock %}

{% block extra_head %}
  <!-- FullCalendar CSS/JS (global build) -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css">
{% endblock %}

{% block content %}
<div class="card">
  <div class="row">
    <h2>Calendar</h2>
    <span class="right muted">
      {% if is_admin %}
        Viewing: All approved leave
      {% else %}
        Viewing: Your approved leave
      {% endif %}
    </span>
  </div>
</div>

<div class="card">
  <div id="calendar" style="background:#fff; border-radius:8px; overflow:hidden;"></div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    const el = document.getElementById('calendar');
    const calendar = new FullCalendar.Calendar(el, {
      initialView: 'dayGridMonth',
      height: 'auto',
      headerToolbar: {
        left: 'prev,next today',
        center: 'title',
        right: 'dayGridMonth,timeGridWeek,timeGridDay'
      },
      events: {
        url: '{{ url_for("calendar_data") }}',
        failure: () => alert('Failed to load events.')
      }
    });
    calendar.render();
  });
</script>
{% endblock %}
