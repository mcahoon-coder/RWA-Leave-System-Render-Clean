{% extends "base.html" %}
{% block content %}
<h2 style="margin-bottom: 0.25rem;">Calendar</h2>

<div class="card" style="padding: 0.5rem 1rem 1rem;">
  <div style="text-align: right; margin-bottom: 0.25rem;">
    <button onclick="printCalendar()" class="btn btn-primary">üñ®Ô∏è Print Calendar</button>
  </div>

  <div id="calendar"></div>
</div>

<!-- FullCalendar -->
<link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js"></script>

<!-- Print styling -->
<style>
  @media print {
    @page {
      size: landscape;
      margin: 0.35in;
    }

    body {
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    /* Hide navigation UI, but keep title and grid */
    .nav,
    .btn,
    .fc-header-toolbar .fc-toolbar-chunk button {
      display: none !important;
    }

    /* Keep heading and shrink space above calendar */
    h2 {
      text-align: center;
      margin-top: 0 !important;
      margin-bottom: 0.2rem !important;
      font-size: 1.4rem !important;
    }

    .card {
      border: none !important;
      box-shadow: none !important;
      padding-top: 0 !important;
    }

    .fc-header-toolbar {
      margin: 0 0 4px 0 !important;
      padding: 0 !important;
    }

    /* Slight scale to fit on one page */
    #calendar {
      transform: scale(0.9);
      transform-origin: top center;
    }

    /* Preserve grid alignment & borders */
    .fc {
      font-size: 11px;
      line-height: 1.2;
    }
    .fc .fc-scrollgrid,
    .fc table {
      border-collapse: collapse !important;
      table-layout: fixed !important;
    }
    .fc .fc-scrollgrid {
      border: 1px solid #d1d5db !important;
    }
    .fc .fc-col-header-cell,
    .fc .fc-daygrid-day {
      border: 1px solid #d1d5db !important;
    }
    .fc .fc-col-header-cell-cushion {
      padding: 3px 5px !important;
    }
    .fc .fc-daygrid-day-top {
      justify-content: flex-end !important;
      padding: 2px 4px !important;
    }
    .fc .fc-daygrid-day-frame {
      padding: 2px !important;
    }
    .fc .fc-daygrid-event {
      margin: 1px 0 !important;
      padding: 1px 2px !important;
      border-radius: 2px !important;
    }
  }
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const el = document.getElementById('calendar');
  const cal = new FullCalendar.Calendar(el, {
    timeZone: 'America/New_York',
    initialView: 'dayGridMonth',
    height: 'auto',
    headerToolbar: {
      left: 'prev,next today',
      center: 'title',
      right: 'dayGridMonth,dayGridWeek,dayGridDay'
    },
    fixedWeekCount: false,
    firstDay: 0,
    displayEventTime: false,
    events: '/calendar-data',
    eventDidMount: function(info) {
      info.el.title = info.event.title;
    }
  });

  cal.render();
});

function printCalendar() {
  window.print();
}
</script>
{% endblock %}
