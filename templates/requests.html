{% extends "base.html" %}
{% block title %}Requests{% endblock %}

{% block content %}
<h2>Leave Requests</h2>

{% if reqs %}
<table class="requests-table">
  <tr>
    <th>User</th><th>Kind</th><th>Mode</th><th>Hours</th><th>Status</th><th>Dates</th><th>Actions</th>
  </tr>
  {% for r in reqs %}
  <tr>
    <td>{{ r.user.username }}</td>
    <td>{{ r.kind }}</td>
    <td>{{ r.mode }}</td>
    <td>{{ r.hours }}</td>
    <td>
      {% if r.status == "Approved" %}
        <span style="color:green">{{ r.status }}</span>
      {% elif r.status == "Disapproved" %}
        <span style="color:orange">{{ r.status }}</span>
      {% else %}
        {{ r.status }}
      {% endif %}
    </td>
    <td>{{ r.start_date }} â†’ {{ r.end_date }}</td>
    <td>
      {% if is_admin and r.status == "Pending" %}
        <form method="post" action="{{ url_for('approve', req_id=r.id) }}" style="display:inline">
          <button class="btn">Approve</button>
        </form>
        <form method="post" action="{{ url_for('disapprove', req_id=r.id) }}" style="display:inline">
          <button class="btn btn-danger">Disapprove</button>
        </form>
      {% endif %}
      {% if r.status in ["Pending", "Approved"] %}
        <form method="post" action="{{ url_for('cancel', req_id=r.id) }}" style="display:inline">
          <button class="btn btn-secondary">Cancel</button>
        </form>
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>
{% else %}
<p>No requests found.</p>
{% endif %}
{% endblock %}
